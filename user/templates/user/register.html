{% extends "base.html" %}
{% load static %}
{% block style %}
<style>
.img {
    width: 150px; 
    height: 150px;
    border-radius: 25%;
    object-fit: cover;
}
</style>
{% endblock %}
{% block script %}
<script>
$(document).ready(function() {
    // 아이 사진 미리보기
    $("#kid_img_btn").change(function() {
        $('.img').removeAttr('src')
        if(this.files[0]) {
            let reader = new FileReader()
            reader.readAsDataURL(this.files[0])
    
            reader.addEventListener('load', function() {
                $('.img').attr('src', reader.result)
                readerResult = reader.result
            }, false)
        }
    })

    // 아이 생년월일 선택(달력)
    $("#kid_birth_date").datepicker({
        dateFormat: 'yy-mm-dd',
        showOtherMonths: true,
        showMonthAfterYear:true,
        changeYear: true,
        changeMonth: true,                           
        yearSuffix: "년",
        monthNamesShort: ['1월','2월','3월','4월','5월','6월','7월','8월','9월','10월','11월','12월'],
        monthNames: ['1월','2월','3월','4월','5월','6월','7월','8월','9월','10월','11월','12월'],
        dayNamesMin: ['일','월','화','수','목','금','토'],
        dayNames: ['일요일','월요일','화요일','수요일','목요일','금요일','토요일'],
        minDate: "-10Y",
        maxDate: "+0d" 
    })
})
</script>
{% endblock %}
{% block content %}
<div class='container'>
    <div class='row my-5'>
        <div class='col'></div>
        <div class='col-6'>
            <form action='.' method='POST' enctype='multipart/form-data'>
                {% csrf_token %}
                <div class='row mx-5'>
                    <div class='col mt-4'>
                        <div class='row'>
                            <div class="col pl-0">
                                <p class='font-weight-bold' for='kid_img'>아이 사진</p>
                            </div>
                        </div>
                        <div class='row mb-2 justify-content-between'>
                            <img class="img mb-2" src="{% static 'images/kid_profile_default.png' %}" alt="이미지없음"/>
                        </div>
                        <div class='row mb-2 justify-content-start'>
                            <input type="file" name="img" id="kid_img_btn" accept=".jpg, .png" 
                                value="{{ form.img.value }}">
                            <small class='mt-1 text-danger'> {{img_error_msg}} </small>
                        </div>
                        <div class='row mb-2' id=kid_name_div>
                            <label class='font-weight-bold' for='kid_name'>아이 이름</label>
                            <div class='input-group'>
                                <input type='text' class='form-control' name='name' id='kid_name' placeholder='아이 이름을 입력하세요.' required>
                            </div>
                        </div>
                        <div class='row mb-2'>
                            <label class='font-weight-bold form-label' for='kid_birth_date'>아이 생년월일</label>
                            <input type="text" class='form-control' name='birthday' id="kid_birth_date" placeholder='yyyy-mm-dd' required>
                            <small class='mt-1 text-danger'> {{birthday_error_msg}} </small>
                        </div>
                        <div class='row mb-2'>
                            <label class='font-weight-bold' for='kid_height'>아이 신장</label>
                            <input type='text' class='form-control' name='height' id='kid_height' placeholder='(cm)' required>
                            <small class='mt-1 text-danger'> {{height_error_msg}} </small>
                        </div>
                        <div class='row mb-3'>
                            <label class='font-weight-bold' for='kid_weight'>아이 체중</label>
                            <input type='text' class='form-control' name='weight' id='kid_weight' placeholder='(kg)' required>
                            <small class='mt-1 text-danger'> {{weight_error_msg}} </small>
                        </div>
                        <div class="row justify-content-between">
                            <a class='btn sub_btn mr-1' data-toggle='modal' data-target='#modal'>이전</a>
                            <button class="btn main_btn">아이등록</button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <div class='col'></div>
    </div>
</div>
<div class='modal fade' id='modal' tabindex='-1'>
    <div class='modal-dialog'>
        <div class='modal-content'>
            <div class='modal-header'>
                <strong>돌아가기</strong>
                <button type='button' class='close' data-dismiss='modal'>
                    <span>x</span>
                </button>
            </div>
            <div class='modal-body text-center'>
                <p>이전 단계로 돌아가시겠습니까?</p>
                <small>
                    현재 진행단계의 변경사항이 저장되지 않습니다.
                </small>
            </div>
            <div class='modal-footer justify-content-center'>
                <button class='btn btn-outline-secondary' data-dismiss='modal'>아니오</button>
                <a href='../select_kid' class='btn btn-secondary'>&nbsp;&nbsp;&nbsp;예&nbsp;&nbsp;&nbsp;</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
