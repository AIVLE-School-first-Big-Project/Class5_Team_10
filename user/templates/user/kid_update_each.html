{% extends "base.html" %}
{% load static %}
{% block content %}
<div class='container'>
    <div class='row my-5'>
        <div class='col'></div>
        <div class='col-6'>
            <form action='.' method='POST' enctype='multipart/form-data'>
                {% csrf_token %}
                <div class='row mx-5'>
                    <div class='col mt-4'>
                        <div class='row'>
                            <div class="col pl-0">
                                <p class='font-weight-bold' for='kid_img'>아이 사진</p>
                            </div>
                        </div>
                        <div class='row mb-2 justify-content-between'>
                            <img class="img mb-2" src="{{ kid.img.url }}"/>
                        </div>
                        <div class='row mb-4 justify-content-start'>
                            <input type="file" name="img" id="kid_img_btn" accept=".jpg, .png"
                                value="{{ kid.img.url }}">
                        </div>
                        <div class="row my-2" id=kid_name_div>
                            <label class="col-2 px-0 font-weight-bold">이름</label>
                            <span class="col-4 pl-4">{{ kid.name }}</span>
                        </div>
                        <div class="row mb-2">
                            <label class="col-2 px-0 font-weight-bold">생년월일</label>
                            <span class='col-4 pl-4'>{{ kid.birthday }}</span>
                        </div>
                        <div class='row mb-2'>
                            <label class='font-weight-bold' for='kid_height'>아이 신장</label>
                            <input type='text' class='form-control' name='height' id='kid_height'
                                placeholder='(cm)' required value="{{kid.height}}">
                        </div>
                        <div class='row mb-3'>
                            <label class='font-weight-bold' for='kid_weight'>아이 체중</label>
                            <input type='text' class='form-control' name='weight' id='kid_weight' 
                                placeholder='(kg)' required value="{{kid.weight}}">
                        </div>
                        <div class="row justify-content-between">
                            <a class='btn btn-outline-secondary mr-1' data-toggle='modal' data-target='#modal'>이전</a>
                            <button class="btn btn-secondary">수정완료</button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <div class='col'></div>
    </div>
</div>
<div class='modal fade' id='modal' tabindex='-1'>
    <div class='modal-dialog'>
        <div class='modal-content'>
            <div class='modal-header'>
                <strong>돌아가기</strong>
                <button type='button' class='close' data-dismiss='modal'>
                    <span>x</span>
                </button>
            </div>
            <div class='modal-body text-center'>
                <p>이전 단계로 돌아가시겠습니까?</p>
                <small>
                    현재 진행단계의 변경사항이 저장되지 않습니다.
                </small>
            </div>
            <div class='modal-footer justify-content-center'>
                <button class='btn btn-outline-secondary' data-dismiss='modal'>아니오</button>
                <a href="{% url 'meal:meal' %}" class='btn btn-secondary'>&nbsp;&nbsp;&nbsp;예&nbsp;&nbsp;&nbsp;</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block style %}
<style>
.img {
    width: 150px; 
    height: 150px;
    border-radius: 25%;
    object-fit: cover;
}
</style>
{% endblock %}
{% block script %}
<script>
$(document).ready(function() {
    // 아이 사진 미리보기
    $("#kid_img_btn").change(function() {
        $('.img').removeAttr('src')
        if(this.files[0]) {
            let reader = new FileReader()
            reader.readAsDataURL(this.files[0])
    
            reader.addEventListener('load', function() {
                $('.img').attr('src', reader.result)
                readerResult = reader.result
            }, false)
        }
    })
})
</script>
{% endblock %}